{"version":3,"file":"sidepanel.html-d9e93870.js","sources":["../../src/assets/icons/premium.svg","../../src/app/pages/SidePanelPage.tsx","../../src/app/sidepanel.tsx"],"sourcesContent":["export default \"__VITE_ASSET__06c7e732__\"","import cx from 'classnames'\nimport { useAtom } from 'jotai'\nimport { useCallback, useMemo } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport clearIcon from '~/assets/icons/clear.svg'\nimport Button from '~app/components/Button'\nimport ChatMessageInput from '~app/components/Chat/ChatMessageInput'\nimport ChatMessageList from '~app/components/Chat/ChatMessageList'\nimport SwitchBotDropdown from '~app/components/SwitchBotDropdown'\nimport { CHATBOTS } from '~app/consts'\nimport { ConversationContext, ConversationContextValue } from '~app/context'\nimport { useChat } from '~app/hooks/use-chat'\nimport { sidePanelBotAtom } from '~app/state'\n\nfunction SidePanelPage() {\n  const { t } = useTranslation()\n  const [botId, setBotId] = useAtom(sidePanelBotAtom)\n  const botInfo = CHATBOTS[botId]\n  const chat = useChat(botId)\n\n  const onSubmit = useCallback(\n    async (input: string) => {\n      chat.sendMessage(input)\n    },\n    [chat],\n  )\n\n  const resetConversation = useCallback(() => {\n    if (!chat.generating) {\n      chat.resetConversation()\n    }\n  }, [chat])\n\n  const context: ConversationContextValue = useMemo(() => {\n    return {\n      reset: resetConversation,\n    }\n  }, [resetConversation])\n\n  return (\n    <ConversationContext.Provider value={context}>\n      <div className=\"flex flex-col overflow-hidden bg-primary-background h-full\">\n        <div className=\"border-b border-solid border-primary-border flex flex-row items-center justify-between gap-2 py-3 mx-3\">\n          <div className=\"flex flex-row items-center gap-2\">\n            <img src={botInfo.avatar} className=\"w-4 h-4 object-contain rounded-full\" />\n            <span className=\"font-semibold text-primary-text text-xs\">{botInfo.name}</span>\n            <SwitchBotDropdown selectedBotId={botId} onChange={setBotId} />\n          </div>\n          <div className=\"flex flex-row items-center gap-3\">\n            <img\n              src={clearIcon}\n              className={cx('w-4 h-4', chat.generating ? 'cursor-not-allowed' : 'cursor-pointer')}\n              onClick={resetConversation}\n            />\n          </div>\n        </div>\n        <ChatMessageList botId={botId} messages={chat.messages} className=\"mx-3\" />\n        <div className=\"flex flex-col mx-3 my-3 gap-3\">\n          <hr className=\"grow border-primary-border\" />\n          <ChatMessageInput\n            mode=\"compact\"\n            disabled={chat.generating}\n            autoFocus={true}\n            placeholder=\"Ask me anything...\"\n            onSubmit={onSubmit}\n            actionButton={\n              chat.generating ? (\n                <Button text={t('Stop')} color=\"flat\" size=\"small\" onClick={chat.stopGenerating} />\n              ) : (\n                <Button text={t('Send')} color=\"primary\" type=\"submit\" size=\"small\" />\n              )\n            }\n          />\n        </div>\n      </div>\n    </ConversationContext.Provider>\n  )\n}\n\nexport default SidePanelPage\n","import { useCallback } from 'react'\nimport { createRoot } from 'react-dom/client'\nimport { useTranslation } from 'react-i18next'\nimport Browser from 'webextension-polyfill'\nimport premiumIcon from '~/assets/icons/premium.svg'\nimport Button from './components/Button'\nimport { usePremium } from './hooks/use-premium'\nimport './i18n'\nimport SidePanelPage from './pages/SidePanelPage'\nimport { trackEvent } from './plausible'\nimport './base.scss'\nimport './sidepanel.css'\n\nfunction PremiumOnly() {\n  const { t } = useTranslation()\n\n  const openPremiumPage = useCallback(() => {\n    trackEvent('open_premium_from_sidepanel')\n    window.open(Browser.runtime.getURL('app.html#/premium'), '_blank')\n  }, [])\n\n  return (\n    <div className=\"w-full h-full flex flex-col justify-center items-center gap-3\">\n      <img src={premiumIcon} className=\"w-10 h-10\" />\n      <div className=\"text-xl font-bold\">{t('Premium Feature')}</div>\n      <Button text={t('Upgrade to unlock')} color=\"primary\" onClick={openPremiumPage} />\n    </div>\n  )\n}\n\nfunction SidePanelApp() {\n  const premiumState = usePremium()\n  if (premiumState.isLoading) {\n    return null\n  }\n  if (premiumState.activated) {\n    return <SidePanelPage />\n  }\n  return <PremiumOnly />\n}\n\nconst container = document.getElementById('app')!\nconst root = createRoot(container)\nroot.render(<SidePanelApp />)\n"],"names":["premiumIcon","SidePanelPage","t","useTranslation","botId","setBotId","useAtom","sidePanelBotAtom","botInfo","CHATBOTS","chat","useChat","onSubmit","useCallback","input","resetConversation","context","useMemo","jsx","ConversationContext","jsxs","SwitchBotDropdown","clearIcon","cx","ChatMessageList","ChatMessageInput","Button","PremiumOnly","openPremiumPage","trackEvent","Browser","SidePanelApp","premiumState","usePremium","container","root","createRoot"],"mappings":"sSAAA,MAAeA,EAAA,+BCcf,SAASC,GAAgB,CACjB,KAAA,CAAE,EAAAC,GAAMC,IACR,CAACC,EAAOC,CAAQ,EAAIC,EAAQC,CAAgB,EAC5CC,EAAUC,EAASL,CAAK,EACxBM,EAAOC,EAAQP,CAAK,EAEpBQ,EAAWC,EAAA,YACf,MAAOC,GAAkB,CACvBJ,EAAK,YAAYI,CAAK,CACxB,EACA,CAACJ,CAAI,CAAA,EAGDK,EAAoBF,EAAAA,YAAY,IAAM,CACrCH,EAAK,YACRA,EAAK,kBAAkB,CACzB,EACC,CAACA,CAAI,CAAC,EAEHM,EAAoCC,EAAAA,QAAQ,KACzC,CACL,MAAOF,CAAA,GAER,CAACA,CAAiB,CAAC,EAGpB,OAAAG,EAAA,IAACC,EAAoB,SAApB,CAA6B,MAAOH,EACnC,SAAAI,EAAAA,KAAC,MAAI,CAAA,UAAU,6DACb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,yGACb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,mCACb,SAAA,CAAAF,EAAA,IAAC,MAAI,CAAA,IAAKV,EAAQ,OAAQ,UAAU,sCAAsC,EACzEU,EAAA,IAAA,OAAA,CAAK,UAAU,0CAA2C,WAAQ,KAAK,EACvEA,EAAA,IAAAG,EAAA,CAAkB,cAAejB,EAAO,SAAUC,EAAU,CAAA,EAC/D,EACAa,EAAAA,IAAC,MAAI,CAAA,UAAU,mCACb,SAAAA,EAAA,IAAC,MAAA,CACC,IAAKI,EACL,UAAWC,EAAG,UAAWb,EAAK,WAAa,qBAAuB,gBAAgB,EAClF,QAASK,CAAA,CAAA,EAEb,CAAA,EACF,QACCS,EAAgB,CAAA,MAAApB,EAAc,SAAUM,EAAK,SAAU,UAAU,OAAO,EACzEU,EAAAA,KAAC,MAAI,CAAA,UAAU,gCACb,SAAA,CAACF,EAAAA,IAAA,KAAA,CAAG,UAAU,4BAA6B,CAAA,EAC3CA,EAAA,IAACO,EAAA,CACC,KAAK,UACL,SAAUf,EAAK,WACf,UAAW,GACX,YAAY,qBACZ,SAAAE,EACA,aACEF,EAAK,WACHQ,EAAAA,IAACQ,EAAO,CAAA,KAAMxB,EAAE,MAAM,EAAG,MAAM,OAAO,KAAK,QAAQ,QAASQ,EAAK,cAAA,CAAgB,EAEjFQ,EAAA,IAACQ,EAAO,CAAA,KAAMxB,EAAE,MAAM,EAAG,MAAM,UAAU,KAAK,SAAS,KAAK,OAAQ,CAAA,CAAA,CAG1E,CAAA,EACF,CAAA,CACF,CAAA,CACF,CAAA,CAEJ,CChEA,SAASyB,GAAc,CACf,KAAA,CAAE,EAAAzB,GAAMC,IAERyB,EAAkBf,EAAAA,YAAY,IAAM,CACxCgB,EAAW,6BAA6B,EACxC,OAAO,KAAKC,EAAQ,QAAQ,OAAO,mBAAmB,EAAG,QAAQ,CACnE,EAAG,CAAE,CAAA,EAGH,OAAAV,EAAA,KAAC,MAAI,CAAA,UAAU,gEACb,SAAA,CAAAF,EAAA,IAAC,MAAI,CAAA,IAAKlB,EAAa,UAAU,YAAY,QAC5C,MAAI,CAAA,UAAU,oBAAqB,SAAAE,EAAE,iBAAiB,EAAE,EACzDgB,EAAAA,IAACQ,GAAO,KAAMxB,EAAE,mBAAmB,EAAG,MAAM,UAAU,QAAS0B,EAAiB,CAClF,CAAA,CAAA,CAEJ,CAEA,SAASG,GAAe,CACtB,MAAMC,EAAeC,IACrB,OAAID,EAAa,UACR,KAELA,EAAa,gBACP/B,EAAc,CAAA,CAAA,QAEhB0B,EAAY,CAAA,CAAA,CACtB,CAEA,MAAMO,EAAY,SAAS,eAAe,KAAK,EACzCC,EAAOC,EAAWF,CAAS,EACjCC,EAAK,OAAQjB,EAAAA,IAAAa,EAAA,CAAa,CAAA,CAAE"}